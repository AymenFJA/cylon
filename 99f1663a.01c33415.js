(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{149:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return b})),a.d(t,"default",(function(){return s}));var n=a(2),r=a(9),o=(a(0),a(162)),l=a(170),i={id:"arch",title:"Architecture"},c={id:"arch",isDocsHomePage:!1,title:"Architecture",description:"Cylon is a data engineering toolkit designed to work with AI/ML systems and",source:"@site/docs/arch.md",permalink:"/docs/arch",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/arch.md",sidebar:"someSidebar",previous:{title:"Compiling",permalink:"/docs/"},next:{title:"C++",permalink:"/docs/cpp"}},b=[{value:"Data Model",id:"data-model",children:[]},{value:"Operators",id:"operators",children:[]},{value:"Communication Layer",id:"communication-layer",children:[]},{value:"Transport Layer",id:"transport-layer",children:[]},{value:"<em>Data Processing Everywhere</em>",id:"data-processing-everywhere",children:[{value:"Data Processing Library",id:"data-processing-library",children:[]},{value:"Data Processing Framework",id:"data-processing-framework",children:[]}]},{value:"Performance results",id:"performance-results",children:[]}],p={rightToc:b};function s(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},p,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cylondata/cylon"}),"Cylon")," is a data engineering toolkit designed to work with AI/ML systems and\nintegrate with data processing systems. ",Object(o.b)("em",{parentName:"p"},'"Data engineering everywhere"')," is the main vision of Cylon. "),Object(o.b)("img",{alt:"Data Engineering Everywhere",src:Object(l.a)("img/docs/wheel.png")}),Object(o.b)("p",null,"It can be deployed either as a library or a framework.\nBig Data systems like ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://spark.apache.org/"}),"Apache Spark"),", ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://flink.apache.org/"}),"Apache Flink"),", ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://twister2.org/"}),"Twister2"),", etc may use Cylon to boost the performance\nin the ETL pipeline. For AI/ML systems like ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://pytorch.org/"}),"PyTorch"),", ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.tensorflow.org/"}),"Tensorflow")," and ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://mxnet.apache.org/"}),"Apache MXNet"),",\nCylon acts as a library to enhance ETL performance. Additionally, Cylon is being expanded to perform as a generic framework\nfor supporting ETL and efficient distributed modeling of AI/ML workloads. "),Object(o.b)("p",null,'Cylon currently provides a set of distributed data-parallel operators to extract, transform and load structured\nrelational data. These operators are exposed as APIs in multiple programming languages (e.g., C++, Python, Java)\nthat are commonly used in Machine Learning and Artificial Intelligence platforms, enabling tight integration with them.\nWhen an operator is invoked in any of these platforms, that invocation is delegated to the "Core Cylon" framework,\nwhich implements the actual logic to perform the operation in a distributed setting.'),Object(o.b)("img",{alt:"Core Cylon Architecture",src:Object(l.a)("img/docs/arch.png")}),Object(o.b)("h2",{id:"data-model"},"Data Model"),Object(o.b)("p",null,"Cylon workloads can be categorized as Online Analytical Processing (OLAP). The data layer of Cylon is based on ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://arrow.apache.org/"}),"Apache Arrow"),".\n",Object(o.b)("em",{parentName:"p"},"Arrow Columnar Format")," provides the foundation for Cylon Table API. "),Object(o.b)("p",null,"Using Apache Arrow has a number of advantages. "),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Seamless integration of other open source frameworks (ex: Spark, Pandas, Parquet, NumPy, etc)")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Zero copy reads, which drastically reduces the overhead of switching between language runtimes")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Allows SIMD operations on columns, data locality and cache, and effective compression of data."))),Object(o.b)("h2",{id:"operators"},"Operators"),Object(o.b)("p",null,"Cylon offers both ",Object(o.b)("em",{parentName:"p"},"local")," and ",Object(o.b)("em",{parentName:"p"},"distributed")," operations. "),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("em",{parentName:"p"},"Local operators")," - Work entirely on the data available and accessible locally to the process (Do not use network layer)")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("em",{parentName:"p"},"Distributes Operators")," - Use the network layer at one or multiple points during the operator\u2019s life-cycle\n(beginning, middle, or end) and apply ",Object(o.b)("em",{parentName:"p"},"local operators")," once the partitions are collected at each local process"))),Object(o.b)("p",null,"Following operators are currently available in Cylon. "),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Select")," - Filters out a set of rows based on the values of all or a subset of columns")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Project")," - Creates a simpler view of an existing table by dropping one or more columns (It is considered the\ncounterpart of Select, which works on columns instead of rows.")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Join")," - Combines two tables based on the values of a common column (Inner, Left Outer, Right Outer, Full Outer\njoins are supported). Currently Cylon joins provide ",Object(o.b)("em",{parentName:"p"},"sort")," and ",Object(o.b)("em",{parentName:"p"},"hash")," join algorithms. ")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Union")," - Concatenates two homogeneous tables (those having similar schema)")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Intersect")," - Produces similar(equal) rows from two homogeneous tables")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Difference")," - Takes the difference between two tables "))),Object(o.b)("h2",{id:"communication-layer"},"Communication Layer"),Object(o.b)("p",null,"The communication layer of Cylon is currently implemented on OpenMPI. An implementation based on UCX is on the road-map\nwhich will enhance Cylon\u2019s compatibility to run on a wide variety of hardware devices such as GPUs, and different\nprocessor architectures. Transport layer options will also be widened with different communication layer implementations.\nCylon uses synchronized producers and consumers for transferring messages."),Object(o.b)("h2",{id:"transport-layer"},"Transport Layer"),Object(o.b)("p",null,"Currently, Cylon has the capability to communicate using any transport layer protocol supported by OpenMPI,\nincluding TCP and Infiniband. Additionally, all the tuning parameters of OpenMPI are applicable for Cylon\nsince the initial implementation is entirely written based on the OpenMPI framework."),Object(o.b)("h2",{id:"data-processing-everywhere"},Object(o.b)("em",{parentName:"h2"},"Data Processing Everywhere")),Object(o.b)("h3",{id:"data-processing-library"},"Data Processing Library"),Object(o.b)("p",null,"Cylon can be directly imported as a library to an application written in another framework. In a Python program, this\nintegration is a simple module import. Cylon Python API currently supports Google Colab with an experimental version\nand supports Jupyter Notebooks with fully-fledged compatibility."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'from torch import Tensor as TorchTensor\nfrom pycylon.data.table import Table, csv_reader\n#...\n\nfile = "data.csv"\ntb = csv_reader.read(file, ",")\n\n# Does data pre-processing\n#...\n\ntb_arw = Table.to_arrow(tb)\nnpy = tb_arw.to_pandas().to_numpy()\ntensor = torch.from_numpy(npy)\n#...\n')),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-cpp"}),'#include <net/mpi/mpi_communicator.h>\n#include <ctx/cylon_context.h>\n#include <table.hpp>\n\nusing namespace cylon;\n//...\n\nint main(int argc, char *argv[]) {\n  std::shared_ptr<Table> table1, table2, joined;\n\n  // initializing cylon in distributed mode\n  auto mpi_config = new MPIConfig();\n  auto ctx = CylonContext::InitDistributed(mpi_config);\n  auto read_options = CSVReadOptions().UseThreads(true);\n\n  // loading multiple table partitions concurrently\n  auto status = Table::FromCSV(ctx, {\n      "/path/to/csv1.csv",\n      "/path/to/csv2.csv"\n  }, {table1, table2}, read_options);\n\n  if (status.is_ok()) {\n    auto join_config = JoinConfig::InnerJoin(0, 0);\n    auto join_status = table1->DistributedJoin(table2, join_config, &joined);\n    if (join_status.is_ok()) { // writing the partition of this worker back to the disk\n      joined->WriteCSV("/path/to/out.csv");\n    } else {\n      // failed\n    }\n  } else {\n    // failed\n  }\n  ctx->Finalize();\n  return 0;\n}\n')),Object(o.b)("h3",{id:"data-processing-framework"},"Data Processing Framework"),Object(o.b)("p",null,"Cylon can also perform as a separate standalone distributed framework to process data. As a distributed framework, Cylon\nshould bring up the processes in different cluster management environments such as Kubernetes, Slurm and Yarn. Cylon has\na distributed backend abstraction to plug in various cluster process management systems. Currently, it works as a\nstandalone framework with the MPI backend."),Object(o.b)("h2",{id:"performance-results"},"Performance results"),Object(o.b)("p",null,"Following is the Cylon performance on Joins against Apache Spark and Dask. "),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Workers"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Dask Time ","(","s",")"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Spark Time ","(","s",")"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Cylon Time ","(","s",")"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Cylon v","."," Dask"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Cylon v","."," Spark"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"1"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"-"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"586",".","5"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"141",".","5"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"-"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4",".","1x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"2"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"-"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"332",".","8"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"116",".","2"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"-"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"2",".","9x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"246",".","7"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"207",".","1"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"56",".","5"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4",".","4x"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"3",".","7x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"8"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"134",".","6"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"119",".","0"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"27",".","4"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4",".","9x"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4",".","3x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"16"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"134",".","2"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"62",".","3"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"13",".","2"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"10",".","1x"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4",".","7x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"32"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"113",".","1"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"39",".","6"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"7",".","0"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"16",".","1x"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"5",".","6x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"64"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"109",".","0"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"22",".","2"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"4",".","0"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"27",".","4x"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"5",".","6x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"128"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"70",".","6"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"18",".","1"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"2",".","5"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"28",".","1x"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"7",".","2x")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"160"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"68",".","9"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"18",".","0"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"2",".","3"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"30",".","0x"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"7",".","8x")))),Object(o.b)("img",{alt:"Cylon Join Performance",src:Object(l.a)("img/docs/join.png")}))}s.isMDXComponent=!0},162:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u}));var n=a(0),r=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var b=r.a.createContext({}),p=function(e){var t=r.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=p(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),s=p(a),d=n,u=s["".concat(l,".").concat(d)]||s[d]||m[d]||o;return a?r.a.createElement(u,i(i({ref:t},b),{},{components:a})):r.a.createElement(u,i({ref:t},b))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var b=2;b<o;b++)l[b]=a[b];return r.a.createElement.apply(null,l)}return r.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"},163:function(e,t,a){"use strict";var n=a(0),r=a(64);t.a=function(){return Object(n.useContext)(r.a)}},170:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a(79);var n=a(163),r=a(175);function o(e,t){var a=void 0===t?{}:t,o=a.forcePrependBaseUrl,l=void 0!==o&&o,i=a.absolute,c=void 0!==i&&i,b=Object(n.a)().siteConfig,p=(b=void 0===b?{}:b).baseUrl,s=void 0===p?"/":p,m=b.url;if(!e)return e;if(l)return s+e;if(!Object(r.a)(e))return e;var d=s+e.replace(/^\//,"");return c?m+d:d}},175:function(e,t,a){"use strict";function n(e){return!1===/^(https?:|\/\/|mailto:|tel:)/.test(e)}a.d(t,"a",(function(){return n}))}}]);